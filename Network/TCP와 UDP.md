## TCP와 UDP의 비교
## UDP
UDP(User Datagram Protocol, 사용자 데이터그램 프로토콜)는 비연결형 프로토콜 이다. 
IP 데이터그램을 캡슐화하여 보내는 방법과 연결 설정을 하지 않고 보내는 방법을 제공한다. 
UDP는 흐름제어, 오류제어 또는 손상된 세그먼트의 수신에 대한 재전송을 하지 않는다. 이 모두가 사용자 프로세스의 몫이다. UDP가 행하는 것은 포트들을 사용하여 IP 프로토콜에 인터페이스를 제공하는 것이다.

종종 클라이언트는 서버로 짧은 요청을 보내고, 짧은 응답을 기대한다. 만약 요청 또는 응답이 손실된다면, 클라이언트는 time out 되고 다시 시도할 수 있으면 된다. 코드가 간단할 뿐만 아니라 TCP 처럼 초기설정(initial setup)에서 요구되는 프로토콜보다 적은 메시지가 요구된다.

UDP를 사용한 것들에는 DNS가 있다. 어떤 호스트 네임의 IP 주소를 찾을 필요가 있는 프로그램은, DNS 서버로 호스트 네임을 포함한 UDP 패킷을 보낸다. 이 서버는 호스트의 IP 주소를 포함한 UDP 패킷으로 응답한다. 사전에 설정이 필요하지 않으며 그 후에 해제가 필요하지 않다.


## TCP
### TCP(Transmission Control Protocol) 특성
(1) 연결지향(Connection-oriented) 서비스 제공
• 소스 호스트와 수신 호스트 간에 데이터를 전송하기 위해 먼저 호스트 간 연결 설정이 되야 함
![image](https://github.com/jyzayu/TIL/assets/55649979/a4550ce0-5b52-4999-ac7e-08bdf79c1d2e)
[장점]
• 패킷이 순서대로 전송되므로 수신자가
재배치할 필요가 없음
• 패킷이 모두 같은 경로를 통해 전송되
므로 헤더의 라우팅 정보만 필요
(헤더의 오버헤드가 적기 때문에 많은 데이터를
보내는데 유리)
[단점]
• 링크나 노드의 고장 시 많은 패킷의 손실
• 연결에 대한 정보를 모든 노드에서 가져야
하므로 네트워크 확장성이 비연결 서비스에
비해 부족
• 적은 데이터 전송 시 연결 설정으로 인하여
불필요한 전송 지연이 생길 수 있음

(2) 신뢰성 있는 데이터 전송
• TCP에서 신뢰성 있는 전송을 위해 가지는 메커니즘
- 확인 응답(ACK) : 전송된 세그먼트에 대하여 수신 호스트가 정확히 수신한 사실을
소스 호스트에 알려주는 것
- 타이머를 통한 타임 아웃
- 재전송(Retransmission)
- 순서 번호(Sequence Number)
• HTTP, FTP, SMTP와 같은 파일 전송 응용 프로토콜은 TCP를 사용

 타이머 (Timer)
- 소스 호스트는 세그먼트를 전송하면서 타이머를 구동
- 타이머가 종료될 때까지 전송된 세그컨트에 대한 ACK가 오지 않으면 소스 호스트는
세그먼트의 손실로 간주하고 재전송
- 재전송 타이머의 타임 아웃 시간은 데이터를 전송한 후 ACK가 돌아오는 왕복 시간
(Round Trip Time : RTT)에 기반을 두어 계산

 재전송 (Retransmission)
- 전송 호스트가 세그먼트를 전송한 후 일정한 시간이 지나고 그에 대한 ACK가 없으면,
세그먼트가 손실된 것으로 간주하고 재전송

 순서번호(Sequence Number)
- 네트워크에서 송수신되는 데이터는 여러 개의 세그먼트 단위로 나뉘어 전송
→ 세그먼트마다 순서번호를 가지고 있어 올바르게 수신되었는지 판단 가능
- 세그먼트가 중복되거나 뒤바뀌는 경우도 순서번호로 확인 후 재조정 가능

(3) 흐름 제어
• 수신자 여유 버퍼의 크기 이상으로 소스 호스트가 데이터를 보낼 수 없다는 원칙에 기반
수신자가 수신할 수 있는 최대 데이터의 양
수신자에서 자신의 가용 버퍼의 크기(최대 가능한 수신 데이터양)를 소스에게 알려주면 소스는
그 크기에 해당하는 패킷만큼 전송 가능
만약! 수신자가 알려 준 데이터양 이상으로 소스가 데이터를 전송하는 경우
→ 전송된 패킷 손실 발생 가능

(4) 혼잡 제어
• 수신자의 수신 능력은 충분
• 중간 노드, 네트워크 내에서의 문제를 제어하는 것
 링크 대역폭 이상의 데이터 전송
 라우터의 버퍼 오버플로우(overflow) → 패킷의 손실, 패킷 전송 지연 등

(5) 전이중 서비스
• 데이터를 전송하면서 동시에 데이터를 수신
(6) 스트림 데이터 서비스
• 응용 프로그램으로부터 데이터를 수신
→ 적절한 크기의 세그먼트라 불리는 패킷을 만들어 전송
• 구분자(생성된 세그먼트를 구분)는 각 세그먼트를 시작하는 첫 번째 바이트
### TCP 세그먼트 구조
![image](https://github.com/jyzayu/TIL/assets/55649979/d0842039-3309-495b-ae9d-b87602b3ee33)

### TCP 세그먼트 구조
• 16 비트 소스 포트 번호
- 소스 호스트의 응용 프로그램에 할당된 포트 번호
- 프로세스 간 전송을 위하여 IP 주소와 쌍을 이루어 소켓 주소를 만듦
• 16비트 목적지 포트 번호
- 목적지 호스트의 응용 프로그램에 할당된 포트 번호
• 32비트 순서 번호
- 전송되는 현재 세그먼트의 첫 번째 바이트에 부여된 번호
- 흐름 제어에 중요하게 쓰임

• 32 비트 확인 응답 번호
- 수신자 호스트에서 ‘세그먼트 수신했음’을 송신자 호스트에게 알려주는 번호
- 수신자 호스트에서 다음에 받기를 기대하는 세그먼트의 순서 번호
• 4비트 헤더 길이
- TCP 헤더 길이를 32-비트 단어로 나타냄
- TCP 헤더 옵션 길이에 따라 크기가 다름
예) TCP 헤더 길이 = 5, 헤더에 옵션 필드가 없는 20바이트의 헤더
→ 이 필드의 최고 값은 15(1111) 이므로 TCP 헤더의 길이는
20~60바이트 사이 값

• 플래그(Flag) 필드
- 6비트로 이루어짐
- ACK 비트는 ACK 필드 값이 유효함을 나타냄
- RST, SYN, FIN 비트는 TCP 연결 설정 및 해지를 위해 사용
• 16비트 윈도우
- 에러 제어 및 흐름 제어를 위한 수신자 윈도우 크기를 나타냄
• 검사합
- 헤더의 에러 검사용 정보 제공
  
대부분의 인터넷 응용 분야들은 신뢰성 과 순차적인 전달 을 필요로 한다. UDP 로는 이를 만족시킬 수 없으므로 다른 프로토콜이 필요하여 탄생한 것이 TCP이다. TCP(Transmission Control Protocol, 전송제어 프로토콜)는 신뢰성이 없는 인터넷을 통해 종단간에 신뢰성 있는 바이트 스트림을 전송 하도록 특별히 설계되었다. TCP 서비스는 송신자와 수신자 모두가 소켓이라고 부르는 종단점을 생성함으로써 이루어진다. TCP 에서 연결 설정(connection establishment)는 3-way handshake를 통해 행해진다.

모든 TCP 연결은 전이중(full-duplex), 점대점(point to point)방식이다. 전이중이란 전송이 양방향으로 동시에 일어날 수 있음을 의미하며 점대점이란 각 연결이 정확히 2 개의 종단점을 가지고 있음을 의미한다. TCP 는 멀티캐스팅이나 브로드캐스팅을 지원하지 않는다.


###  UDP(User Datagram Protocol) 프로토콜 특성
 • 아주 간단한 트랜스포트 계층 프로토콜
• 응용 계층 프로세스로부터 메시지를 받아 다중화와 역다중화를 위해
소스 포트 번호와 목적지 포트 번호, 헤더 길이, 검사합 필드를 넣어
네트워크 계층으로 전송
• 네트워크 계층의 프로토콜에서 받은 세그먼트를 IP 데이터그램으로
캡슐화하여 목적지 호스트로 전송
• 세그먼트가 목적지 호스트에 도착하면 UDP는 IP 주소와 포트 번호를
이용하여 해당 응용 프로세스에게 세그먼트 내에 있는 데이터 전송
### 장점
• 데이터 전송을 위한 연결 설정 불필요
→ 적은 데이터를 전송하는 DNS(Domain Name Service)나 네트워크 관리
프로토콜인 SNMP(Small Network Management Protocol) 같은 응용에 유리
• TCP에 비해 짧은 헤더 길이
- 간단한 기능을 가진 트랜스포트 계층의 프로토콜 → 헤더 오버헤드가 적음
• 전송률 제어 메커니즘 없음
• 멀티캐스트(multicast) 전송 지원
### 단점
• 데이터를 전송하기 전 프로세서 간의 3단계 연결설정과정 필요 없음
• 비신뢰성 특징
- 수신측에 도착하는 패킷 순서가 일치하지 않을 가능성
- 패킷 손실 발생 가능성
• 단순한 에러 검사만 진행 → 데이터의 신뢰성 보장 안됨

###  UDP 프로토콜의 사용 분야
• 전송 중에 어느 정도의 패킷 손실을 허용하는 오디오/비디오와 같은 멀티미디어
응용의 전송 계층 프로토콜로 사용
• DNS, SNMP 등과 같이 요청
- 응답 전송 방식을 사용하여 패킷 크기가 작은 데이터를 주고받는 응용에 적합

### UDP 세그먼트 구조
![image](https://github.com/jyzayu/TIL/assets/55649979/dbf47f4d-9f8c-4a00-a0bb-982d3ed3d0b1)

