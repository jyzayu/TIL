## google.com 을 입력하면 어떤일이 일어날까

###  1. DNS레코드를 찾기 위해 브라우저는 4개지 캐시를 확인합니다.
1. 브라우저 캐시 확인 → 이전 방문한 웹사이트 인지 확인
2. OS 캐시 확인
3. 라우터 캐시 확인   (라우터에서도 DNS 정보를 저장합니다)
4. ISP 캐시 확인 (ISP는 인터넷 서비스 제공 회사입니다(SK브로드밴드, LG U+ 등) 
(ISP는 DNS 레코드 캐시를 포함하는 자체 DNS 서버를 유지 관리하며, 
브라우저는 요청 된 URL을 찾기 위해 마지막으로 확인합니다.)


### 웹 페이지와 관련된 4개의 DNS Server
DNS 리커서 - 리커서는 도서관의 어딘가에서 특정한 책을 찾아달라고 요청받는 사서로 생각할 수 있습니다. 
DNS 리커서는 웹 브라우저 등의 애플리케이션을 통해 클라이언트 컴퓨터로부터 쿼리를 받도록 고안된 서버입니다.
일반적으로, 리커서는 클라이언트의 DNS 쿼리를 충족시키기 위해 추가 요청을 수행합니다.

루트 이름 서버 - 루트 서버는 사람이 읽을 수 있는 호스트 이름을 IP 주소로 변환(확인)하는 첫 번째 단계입니다. 도서관에서 책장 위치를 가리키는 색인으로 생각할 수 있으며, 일반적으로 다른 더욱 특정한 위치에 대한 참조로 사용됩니다.

TLD 이름 서버 - TLD(최상위 도메인) 서버는 도서관의 특정 책장으로 생각할 수 있습니다. 이 이름 서버는 특정 IP 주소 검색의 다음 단계이며 호스트 이름의 마지막 부분을 호스팅합니다(example.com에서 TLD 서버는 “com”입니다).

권한 있는 이름 서버 - 최종 이름 서버로서, 책장에 있는 사전처럼 특정 이름을 해당 정의로 변환합니다. 권한있는 이름 서버는 이름 서버 쿼리의 종착점입니다. 권한있는 이름 서버가 요청한 레코드에 대한 액세스 권한이 있다면, 요청한 호스트 이름의 IP 주소를 초기 요청을 한 DNS 리커서(사서)에게 돌려 보냅니다.

### 2. DNS를 통해 IP 주소를 얻습니다.
ISP 캐시에서도 IP주소를 찾지 못한 경우, ISP의 DNS Server에 DNS 쿼리를 보냅니다.(요청) 
google.com 의 IP주소를 아는지 여기저기 물어보는 것인데 이를 Recursive Search 라 합니다. 
이는 ISP의 DNS recursor가 담당합니다. 다른 domain name server에 요청을 보내 IP주소를 확인합니다.
![image](https://github.com/jyzayu/TIL/assets/55649979/4e975051-c7f8-42af-8ee1-91667d9fcb28)

### DNS 조회의 8단계:
- 사용자가 웹 브라우저에 'example.com'을 입력하면, 쿼리가 인터넷으로 이동하고 DNS 재귀 확인자가 이를 수신합니다.
- 이어서 확인자가 DNS 루트 이름 서버(.)를 쿼리합니다.
- 다음으로, 루트 서버가, 도메인에 대한 정보를 저장하는 최상위 도메인(TLD) DNS 서버(예: .com 또는 .net)의 주소로 확인자에 응답합니다.
- example.com을 검색할 경우의 요청은 .com TLD를 가리킵니다.
- 이제, 확인자가 .com TLD에 요청합니다.
- 이어서, TLD 서버가 도메인 이름 서버(example.com)의 IP 주소로 응답합니다.
- 마지막으로, 재귀 확인자가 도메인의 이름 서버로 쿼리를 보냅니다.
- 이제, example.com의 IP 주소가 이름 서버에서 확인자에게 반환됩니다.
- 이어서, DNS 확인자가, 처음 요청한 도메인의 IP 주소로 웹 브라우저에 응답합니다.
- DNS 조회의 8단계를 거쳐 example.com의 IP 주소가 반환되면, 이제 브라우저가 웹 페이지를 요청할 수 있습니다.

### 3. 브라우저가 TCP/IP 프로토콜로 서버와 연결 
3way-handshake로 연결하고 IP protocol로 서버에 도달합니다.



### 4. FireWall , HTTPS , SSL
해커가 대규모 트래픽을 보내는 경우에 대비해 firewall을 설치해 특정 IP주소나 지역에서 오는 요청을 막을 수 있습니다.
클라이언트와 서버 암호화를 통해 패킷을 엿보는 것을 방지합니다.

### 5. Load balancer
트래픽을 측정해 구글의 여러대의 서버중 트래픽을 받을 수 있는 서버에게 보냅니다. 트래픽이 망가지거나 지연되지 않도록 합니다.

### 6. HTTP 요청
서버에 첫 웹 페이지를 달라는 HTTP 요청을 보냅니다. 이 요청에는 브라우저 버전과 종류, 쿠키(사용자 정보)가 같이 보내집니다.

### 7.렌더링
- 해당 IP의 서버가 브라우저에서 렌더링할 웹 페이지를 반환합니다(10단계).
렌더링 과정을 거쳐 웹 페이지를 표시하게 됩니다.
1. 불러오기
: 로더(Loader)가 서버로부터 전달받은 리소스 스트림을 읽는 과정

2. DOM, CSSOM 생성
웹 엔진의 HTML/XML 파서가 문서를 파싱해 DOM Tree를, CSS 파서가 CSSOM 트리를 생성(아래 파싱, 스크립트와 스타일 시트의 진행순서 참조)

3. 생성된 DOM과 CSSOM으로 렌더링 트리 생성
DOM Tree + CSSOM Tree, 렌더링에 필효한 노드만 선택해 페이지를 렌더링하는데 사용

4. css, 레이아웃
: 렌더트리를 토대로 그려질 노드와 스타일, 크기를 계산
렌더링 트리에서 위치, 크기등을 알 수 없기 때문에 객체들에게 위치 크기 등을 정해주는 과정, css는 선택자에 따라서 적용되는 태그가 다르기 때문에 모든 css 스타일을 분석해 태그에 스타일 규칙이 적용되게 결정

5. 그리기
: 렌더트리의 각 노드를 실제 픽셀로 변환 ➡️ 실제로 그리는 작업을 실행

참고로 자바스크립트가 DOM, CSSOM을 변경하는 경우 리렌더링
리플로우: 레이아웃 계산을 다시 하는 것
리페인트: 재결합된 렌더 트리를 기반으로 다시 페인트를 하는 것


https://www.cloudflare.com/ko-kr/learning/dns/what-is-dns/

https://brunch.co.kr/@seungjoonlernnx/100
